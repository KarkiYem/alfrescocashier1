(window.webpackJsonp=window.webpackJsonp||[]).push([[54],{446:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var r=n(132);var c=n(176),o=n(90);function d(e){return function(e){if(Array.isArray(e))return Object(r.a)(e)}(e)||Object(c.a)(e)||Object(o.a)(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}},652:function(e,t,n){},738:function(e,t,n){"use strict";n(652)},807:function(e,t,n){"use strict";n.r(t);n(10);var r=n(446),c=n(11),o=(n(171),n(47),n(43),n(69)),d={layout:"DashboardLayout",middleware:["isAuthenticated","checkAdmin"],data:function(){return{result:null,showScanner:!1,debug:!1,scannerInitialized:!1,ok:null,adult:[],kid:[],all:[],cruise:"",deck:"",re_id:"",date:"",infant:0,veg:0,nonveg:0,other:0,status:"",infantdetails:[],board:Boolean,key:0}},methods:{onDetect:function(e){var t=this;return Object(c.a)(regeneratorRuntime.mark((function n(){var r,c,content;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=t,n.next=3,e;case 3:c=n.sent,content=c.content,r.result=null,r.result=content,r.getData(r.result),r.toggleScanner();case 9:case"end":return n.stop()}}),n)})))()},toggleScanner:function(){var e=this;return Object(c.a)(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:(n=e).ok=null,n.showScanner=!n.showScanner,n.showScanner&&!n.scannerInitialized?(n.scannerInitialized=!0,n.key++,setTimeout((function(){window.scrollBy({top:2,behavior:"smooth"})}),1e3)):!n.showScanner&&n.scannerInitialized&&(n.scannerInitialized=!1,n.key--,window.scrollBy({top:-2,behavior:"smooth"}));case 4:case"end":return t.stop()}}),t)})))()},toggleScanners:function(){var e=this;return Object(c.a)(regeneratorRuntime.mark((function t(){var n,data;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return(n=e).ok=null,n.showScanner=!n.showScanner,n.showScanner&&!n.scannerInitialized?n.scannerInitialized=!0:!n.showScanner&&n.scannerInitialized&&(n.scannerInitialized=!1),data={adultdetails:n.adult,kiddetails:n.kid,infantdetails:n.infantdetails},t.next=7,o.a.collection("Booking").update(n.re_id,data);case 7:case"end":return t.stop()}}),t)})))()},opn:function(e,t){var n=this;return Object(c.a)(regeneratorRuntime.mark((function r(){var c,o,d,l;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:c=n,1!=e.dis&&(0==t?-1!=(o=c.adult.findIndex((function(t){return JSON.stringify(t)==JSON.stringify(e)})))&&(c.adult[o].entered=!c.adult[o].entered):1==t?-1!=(d=c.kid.findIndex((function(t){return JSON.stringify(t)==JSON.stringify(e)})))&&(c.kid[d].entered=!c.kid[d].entered):2==t&&-1!=(l=c.infantdetails.findIndex((function(t){return JSON.stringify(t)==JSON.stringify(e)})))&&(c.infantdetails[l].entered=!c.infantdetails[l].entered));case 2:case"end":return r.stop()}}),r)})))()},getData:function(e){var t=this;return Object(c.a)(regeneratorRuntime.mark((function n(){var c,d,l,f,v,dt,h,_,k,m;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return c=t,d=new Date,l=d.getDate(),f=d.getMonth()+1,v=d.getFullYear(),dt="".concat(l,"/").concat(f,"/").concat(v),n.prev=6,n.next=9,o.a.collection("Booking").getFullList({filter:'id="'.concat(e,'" && date="').concat(dt,'"')});case 9:if(0!=(h=n.sent).length){n.next=15;break}return c.ok=!1,n.abrupt("return");case 15:c.ok=!0;case 16:return n.next=18,o.a.collection("settings").getOne("wpaaz5r1qamc9o1");case 18:if(_=n.sent,0==h.length||_.current_boarding==h[0].cruise){n.next=22;break}return c.ok=!1,n.abrupt("return");case 22:c.adult=h[0].adultdetails,c.kid=h[0].kiddetails,c.infantdetails=h[0].infantdetails,c.adult=c.adult.map((function(e,i){var t;return{id:e.id||i,name:e.name,age:e.age,dis:null!==(t=e.entered)&&void 0!==t&&t,entered:!0}})),c.adult.every((function(e){return!1===e.dis}))&&c.sendsms(h[0]),c.kid=c.kid.map((function(e,i){var t;return{id:e.id||i+c.adult.length,name:e.name,age:e.age,dis:null!==(t=e.entered)&&void 0!==t&&t,entered:!0}})),c.infantdetails=c.infantdetails.map((function(e,i){var t;return{id:e.id||i+c.adult.length+c.kid.length,name:e.name,age:e.age,dis:null!==(t=e.entered)&&void 0!==t&&t,entered:!0}})),c.all=[].concat(Object(r.a)(c.adult),Object(r.a)(c.kid),Object(r.a)(c.infantdetails)),k=c.all.every((function(e){return!0===e.dis})),m=c.all.some((function(e){return!1===e.dis})),c.board=k&&!m,c.cruise=h[0].cruise,c.deck=h[0].deck,c.re_id=h[0].id,c.infant=h[0].infant,c.date=h[0].date,c.veg=h[0].veg,c.nonveg=h[0].nonveg,c.other=h[0].other,c.status=h[0].status,c.all=c.all.map((function(e){return{id:e.id,name:e.name,age:e.age,dis:e.entered,entered:e.entered||!0}})),n.next=48;break;case 46:n.prev=46,n.t0=n.catch(6);case 48:case"end":return n.stop()}}),n,null,[[6,46]])})))()},sendsms:function(e){return Object(c.a)(regeneratorRuntime.mark((function t(){var n,dt,r,c,d,i,table,l,dd,f,v,h;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.cruise,dt=e.date,t.next=4,o.a.collection("seats").getFirstListItem('cruise="'.concat(n,'"  && date="').concat(dt,'"'));case 4:if(!(r=t.sent)){t.next=21;break}for(c=[],d=r.UDeck.concat(r.MDeck),i=0;i<d.length;i++)if(table=d[i],Array.isArray(table.obj))for(l=0;l<table.obj.length;l++)table.obj[l].booking_id===e.id&&c.push(table.tablename);return dd=c.join(", "),f={table:dd,deck:e.deck,phone:e.phone},"https://alfrescogrand.com/api/sendConfirmBooking",v={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(f)},t.next=15,fetch("https://alfrescogrand.com/api/sendConfirmBooking",v);case 15:return h=t.sent,t.next=18,h.json();case 18:t.sent,t.next=21;break;case 21:case"end":return t.stop()}}),t)})))()}}},l=(n(738),n(7)),component=Object(l.a)(d,(function(){var e=this,t=e._self._c;return t("div",{staticStyle:{"min-height":"90vh"}},[t("base-header",[t("div",{staticClass:"row align-items-center"},[t("div",{staticClass:"col-lg-6 col-7"},[t("nav",{staticClass:"d-none d-md-inline-block ml-md-4",attrs:{"aria-label":"breadcrumb"}},[t("route-bread-crumb")],1)])])]),e._v(" "),t("div",{staticClass:"rows"},[t("div",{staticClass:"middle"},[t("div",{staticClass:"qrcode"},[e.showScanner?e._e():t("i",{staticClass:"fa fa-qrcode icons"}),e._v(" "),e.showScanner?t("qrcode-reader",{key:e.key,ref:"qrReader",staticStyle:{margin:"20px"},attrs:{debug:e.debug},on:{detect:e.onDetect}}):e._e()],1),e._v(" "),e.showScanner?e._e():t("button",{staticClass:"btn btn-success",on:{click:e.toggleScanner}},[e._v("\n        Scan QR Code\n      ")]),e._v(" "),e.showScanner?t("button",{staticClass:"btn btn-success",staticStyle:{"z-index":"999"},on:{click:e.toggleScanner}},[e._v("\n        Stop\n      ")]):e._e()]),e._v(" "),t("div",{staticClass:"Details"},[e._m(0),e._v(" "),1==e.ok?t("div",[t("div",{staticClass:"co1",staticStyle:{display:"flex"}},[t("h3",[e._v("\n            "+e._s("No Deck"==e.deck?"Dinner Deck":e.deck)+" - "+e._s(e.cruise)+" -\n            "+e._s(e.date)+"\n          ")])]),e._v(" "),t("div",{staticClass:"co1",staticStyle:{display:"flex"}},[t("h3",{staticStyle:{display:"flex"}},[e._v("\n            Booking Status -\n            "),t("div",{staticStyle:{padding:"4px 8px",color:"white","border-radius":"4px","margin-left":"5px"},style:{backgroundColor:"Completed"===e.status?"rgb(14, 226, 14)":"red"}},[e._v("\n              "+e._s(e.status)+"\n            ")])])]),e._v(" "),t("div",{staticClass:"co1",staticStyle:{display:"flex"}},[t("h3",{staticStyle:{display:"flex"}},[e._v("\n            Boarding Status -\n            "),t("div",{staticStyle:{padding:"4px 8px",color:"white","border-radius":"4px","margin-left":"5px"},style:{backgroundColor:!0===e.board?"rgb(14, 226, 14)":"red"}},[e._v("\n              "+e._s(!0===e.board?"Completed":"Not Completed")+"\n            ")])])]),e._v(" "),t("div",{staticClass:"co1",staticStyle:{display:"flex"}},[t("h3",[e._v("\n            "+e._s(e.all.length)+" "+e._s(e.all.length<2?"Person":"Persons")+" :-\n            "+e._s(e.adult.length)+" "+e._s(e.adult.length<2?"Adult":"Adults")+",\n            "+e._s(e.kid.length)+" "+e._s(e.kid.length<2?"Kid":"Kids")+",\n            "+e._s(e.infant)+" "+e._s(e.infant<2?"Infant":"Infants")+",\n          ")])]),e._v(" "),"Dinner Cruise"==e.cruise?t("div",{staticClass:"co1",staticStyle:{display:"flex"}},[t("h3",[e._v("Veg: "+e._s(e.veg)+", Nonveg: "+e._s(e.nonveg)+", Other: "+e._s(e.other)+",")])]):e._e(),e._v(" "),e._l(e.adult,(function(n,r){return t("div",{key:r},[t("div",{staticClass:"co1",staticStyle:{display:"flex"}},[e._v("\n            "+e._s(r+1)+".  \n            "),t("input",{staticClass:"red-input",attrs:{type:"checkbox",disabled:n.dis},domProps:{checked:n.entered},on:{click:function(t){return e.opn(n,0)}}}),e._v(" "),t("h3",[e._v("\n              "+e._s(""==n.name?"Adult ".concat(r):n.name)+"\n            ")])])])})),e._v(" "),e._l(e.kid,(function(n,r){return t("div",{key:r},[t("div",{staticClass:"co1",staticStyle:{display:"flex"}},[e._v("\n            "+e._s(r+1+e.adult.length)+".  \n            "),t("input",{staticClass:"red-input",attrs:{type:"checkbox",disabled:n.dis},domProps:{checked:n.entered},on:{click:function(t){return e.opn(n,1)}}}),e._v(" "),t("h3",[e._v("\n              "+e._s(""==n.name?"Kid ".concat(r+1):n.name)+"\n            ")])])])})),e._v(" "),e._l(e.infantdetails,(function(n,r){return t("div",{key:r},[t("div",{staticClass:"co1",staticStyle:{display:"flex"}},[e._v("\n            "+e._s(r+1+e.adult.length+e.kid.length)+".  \n            "),t("input",{staticClass:"red-input",attrs:{type:"checkbox",disabled:n.dis},domProps:{checked:n.entered},on:{click:function(t){return e.opn(n,2)}}}),e._v(" "),t("h3",[e._v("\n              "+e._s(""==n.name?"Infant ".concat(r+1):n.name)+"\n            ")])])])})),e._v(" "),t("button",{staticClass:"btn btn-success mt-4",on:{click:e.toggleScanners}},[e._v("\n          Ok\n        ")])],2):e._e(),e._v(" "),null==e.ok?t("div",[e._m(1)]):e._e(),e._v(" "),0==e.ok?t("div",[e._m(2)]):e._e()])])],1)}),[function(){var e=this._self._c;return e("div",{staticClass:"co1",staticStyle:{display:"flex"}},[e("h3",[this._v("Customer Details :-")])])},function(){var e=this._self._c;return e("div",{staticClass:"co1",staticStyle:{display:"flex"}},[e("h3",[this._v("Please scan QR to get the details.")])])},function(){var e=this._self._c;return e("div",{staticClass:"co1",staticStyle:{display:"flex"}},[e("h3",[this._v("Invalid QR Code.")])])}],!1,null,"1809d329",null);t.default=component.exports}}]);